<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ODEs modelleren in R – Biologische Modellen en Statistiek</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Modellen/competitie.html" rel="next">
<link href="../Modellen/predatorprooi.html" rel="prev">
<link href="../figuren/favicon/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden",
    "search-label": "Zoeken"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Schakel zijbalknavigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Modellen/intro_modellen.html">Biologische modellen</a></li><li class="breadcrumb-item"><a href="../Modellen/odes_grind.html">ODEs modelleren in R</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Schakel zijbalknavigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Zoeken" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../figuren/favicon/android-chrome-512x512.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Biologische <br>Modellen en Statistiek</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Schakel donkere modus"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Zoeken"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Cursusinformatie</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inleiding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cursusinformatie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algemene cursusinformatie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../planning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Studieplanning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Handige links</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Basisprincipes van R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Programmeren/introductie_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introductie en installatie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Programmeren/introductie_R2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Programmeren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Programmeren/intro_R_questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra R oefeningen</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Basiswiskunde</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/inleiding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Inleiding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/breuken.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Breuken</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/exponenten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exponenten &amp; Logaritmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/limieten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Asymptoten &amp; Limieten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/afgeleiden.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Afgeleiden</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Wiskunde/schetsen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Functies schetsen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Biologische modellen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/intro_modellen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/exponentielegroei.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Exponentiële groei</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/odes_basis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modelleren met ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/dichtheidseffecten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dichtheidseffecten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/ruimtelijkegroei.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ruimtelijke groei</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/predatorprooi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Predator-prooi interacties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/odes_grind.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ODEs modelleren in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/competitie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Competitie en evolutie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/zwermen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Zwermen en foerageren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/reactiediffusie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Reacties en diffusie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/exciteerbaremedia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Exciteerbare media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modellen/project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mini-project</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Statistiek</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Statistiek/wat_is_statistiek.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wat is statistiek?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Bijlagen</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/antwoorden_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Antwoorden R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/antwoorden_wiskunde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Antwoorden wiskunde</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/antwoorden_modellen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Antwoorden modellen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/spiekbriefjes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spiekbriefjes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/dankwoord.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dankwoord</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">Inhoudsopgave</h2>
   
  <ul class="collapse">
  <li><a href="#leerdoelen" id="toc-leerdoelen" class="nav-link active" data-scroll-target="#leerdoelen">Leerdoelen</a></li>
  <li><a href="#de-verzadigde-predator" id="toc-de-verzadigde-predator" class="nav-link" data-scroll-target="#de-verzadigde-predator">De verzadigde predator</a></li>
  <li><a href="#vorm-van-de-nieuwe-predatieterm" id="toc-vorm-van-de-nieuwe-predatieterm" class="nav-link" data-scroll-target="#vorm-van-de-nieuwe-predatieterm">Vorm van de nieuwe predatieterm</a></li>
  <li><a href="#hill-functies" id="toc-hill-functies" class="nav-link" data-scroll-target="#hill-functies">Hill-functies</a></li>
  <li><a href="#grind-tutorial" id="toc-grind-tutorial" class="nav-link" data-scroll-target="#grind-tutorial">Grind tutorial</a></li>
  <li><a href="#lotka-volterra-in-grind" id="toc-lotka-volterra-in-grind" class="nav-link" data-scroll-target="#lotka-volterra-in-grind">Lotka-Volterra in Grind</a></li>
  <li><a href="#bifurcaties-van-evenwichten" id="toc-bifurcaties-van-evenwichten" class="nav-link" data-scroll-target="#bifurcaties-van-evenwichten">Bifurcaties van evenwichten</a></li>
  <li><a href="#grind.r-kan-nog-veel-meer" id="toc-grind.r-kan-nog-veel-meer" class="nav-link" data-scroll-target="#grind.r-kan-nog-veel-meer">grind.R kan nog veel meer</a></li>
  <li><a href="#terminologie" id="toc-terminologie" class="nav-link" data-scroll-target="#terminologie">Terminologie</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Modellen/intro_modellen.html">Biologische modellen</a></li><li class="breadcrumb-item"><a href="../Modellen/odes_grind.html">ODEs modelleren in R</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-grind" class="quarto-section-identifier">ODEs modelleren in R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<script>
  window.onbeforeprint = () => {
    const images = document.querySelectorAll('img#subset')
    images.forEach((img) => { img.style.width = "60%"; });
    const imagesShow = document.querySelectorAll('img#imgToShow')
    imagesShow.forEach((img) => { img.style.display = "block"; });
    
    const videos = document.querySelectorAll('img#imgToShow')
    imagesShow.forEach((img) => { img.style.display = "block"; });
    
    //document.body.style.fontFamily= "Georgia";
    const iframes = document.querySelectorAll("iframe#iframeToReplace");
    iframes.forEach((iframe, index) => {
                // Create a placeholder element with text
                const placeholder = document.createElement('div');
                placeholder.innerHTML += "<br><center><font size=2>(Deze interactieve content vind je op <a href='" + iframe.src + "'> " + iframe.src + " </a>)</font></center><br>"
                iframe.parentNode.replaceChild(placeholder, iframe);
            });
  };
  window.onafterprint = () => {
      window.location.reload(true);
    }
    
  
  
  
  //const iframeContainer =           document.getElementById('iframeContainer');
  //const iframe = document.getElementById('printIframe');
  //window.onbeforeprint = () => {
  // Replace the iframe with a link
  //  iframeContainer.innerHTML = `<p>Deze simulatie kun je bekijken op: <a href="${iframe.src}" target="_blank">${iframe.src}</a></p>`;
  //  document.body.style.fontFamily= "Georgia";
  //};
  //window.onafterprint = () => {
    //  window.location.reload(true);
   // }
</script>
<p>In <a href="predatorprooi.html" class="quarto-xref"><span>14&nbsp; Predator-prooi interacties</span></a> hebben we een heel beroemd model uit de biologie geanalyseerd: het <em>Lotka-Volterra predator-prooi model</em>. Dit model gaat natuurlijk niet specifiek over konijnen en vossen, maar zou op allerlei systemen toegepast kunnen worden: bacteriofagen die bacteriën infecteren, protozoa die bacteriën eten, lieveheersbeestjes die bladluizen eten, vleermuizen die motjes eten, <em>etc.</em> Naast het predator-prooi model bestaat er ook het <em>Lotka-Volterra competitie model</em> (waar we in het volgende hoofdstuk naar gaan kijken). Zodoende is het Lotka-Volterra model uitgegroeid tot één van de meest veelzijdige modellen in de biologie, waarmee voorspellingen gedaan kunnen worden over welke soorten wel/niet kunnen samenleven.</p>
<p>We hebben gezien hoe met behulp van faseruimtes het relatief eenvoudig kan zijn om inzicht in een biologisch proces te vergaten. Maar de eenvoud van deze eerdere analyses is deels te verklaren door de eenvoud van het model dat we hebben gebruikt. Hoe meer interacties we willen begrijpen, hoe moeilijker het zal worden om met pen en papier te werk te gaan. Daarom gaan we leren om ODEs door te rekenen met het Rscript <code>grind.R</code>, waarmee je eenvoudig faseruimtes en grafiekjes van de dynamica van variabelen kan plotten.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="figuren/odes_grind.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Een faseruimte (links) en oplossing (rechts) gegenereerd met het Rscript ‘grind.R’. De zwarte lijnen links tonen trajectories (de dynamica vanaf specifieke initiële condities). De oplossing (rechts) geeft één trajectorie weer als functie van tijd, met de twee variabelen op de y-as."><img src="figuren/odes_grind.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Een faseruimte (links) en oplossing (rechts) gegenereerd met het Rscript ‘grind.R’. De zwarte lijnen links tonen trajectories (de dynamica vanaf specifieke initiële condities). De oplossing (rechts) geeft één trajectorie weer als functie van tijd, met de twee variabelen op de y-as."></a></p>
</figure>
</div>
<figcaption>Een faseruimte (links) en oplossing (rechts) gegenereerd met het Rscript ‘grind.R’. De zwarte lijnen links tonen trajectories (de dynamica vanaf specifieke initiële condities). De oplossing (rechts) geeft één trajectorie weer als functie van tijd, met de twee variabelen op de y-as.</figcaption>
</figure>
</div>
<section id="leerdoelen" class="level2">
<h2 class="anchored" data-anchor-id="leerdoelen">Leerdoelen</h2>
<p>Misschien is het je opgevallen dat dit hoofdstuk geen nummer heeft. Dit hoofdstuk is inhoudelijk namelijk wat korter, en is vooral bedoeld om kennis te maken met het R-script <code>grind.R</code>. De overige leerdoelen zijn:</p>
<ul>
<li>Begrijpen hoe een simpel model (zoals het Lotka-Volterra model) kan worden uitgebreid door extra details toe te voegen (bijvoorbeeld een predator die verzadigd raakt).</li>
<li>Een Hill-functie herkennen, en de kenmerken kunnen benoemen (initiële helling, half-waarde, maximum).</li>
<li>R kunnen gebruiken om faseruimtes met nullclines en trajectories te tekenen, en de daarbij horende oplossingen.</li>
</ul>
</section>
<section id="de-verzadigde-predator" class="level2">
<h2 class="anchored" data-anchor-id="de-verzadigde-predator">De verzadigde predator</h2>
<p>In ons eerdere Lotka-Volterra model namen we aan dat predatie lineair proportioneel is aan de dichtheden van de predator en prooi. Dit deden we door gebruik te maken van een simpele predatieterm: <span class="math inline">\(aRN\)</span>. Mede dankzij deze eenvoud waren de nullclines zo eenvoudig: een stel rechte lijnen waarvan het makkelijk te bepalen is waar/of ze snijden. Echter heeft deze eenvoud ook zijn beperkingen. Dit lineaire verband betekent dat per predator (ookwel: <em>per capita</em>) in totaal <span class="math inline">\(aR\)</span> prooi gegeten kan worden (nogmaals, “per” kun je lezen als “gedeeld door”, dus <span class="math inline">\(\frac{aRN}{N} = aR\)</span>). Bij oneindig hoge prooidichtheden, kan elke predator dus oneindig veel prooi eten. In het echt zal een predator eigenlijk een tijd bezig zijn met het verwerken en verteren van de prooi. Zodoende zal de predatie-term bij hele hoge prooi-dichtheden eigenlijk moeten verzadigen. Om dit te bestuderen met ons model, zouden we de predatie-term aan kunnen passen:</p>
<p><span class="math display">\[\begin{align*}
\frac{\mathrm{d}\color{#2a53f7}R}{\mathrm{d}t} &amp;= \underbrace{b(1-\frac{\color{#2a53f7}R}{K})\color{#2a53f7}R}_{\text{geboorte prooi}} - \underbrace{d\color{#2a53f7}R}_{\text{sterfte prooi}} - \underbrace{\frac{\color{black}a\color{#2a53f7}R\color{orange}N}{h+\color{#2a53f7}R}}_{\text{nieuwe predatieterm}}\\
\frac{\mathrm{d}\color{orange}N}{\mathrm{d}t} &amp;= \underbrace{\frac{a\color{#2a53f7}R\color{orange}N}{h+\color{#2a53f7}R\color{black}}}_{\text{geboorte predator}} - \underbrace{\delta \color{orange}N}_{\text{sterfte predator}}
\end{align*}\]</span></p>
<p>Wat is met deze nieuwe predator-term de <em>per capita</em> predatie? Dat wil zeggen: hoeveel prooi kan een enkele predator per tijdseenheid opeten? Hiervoor delen we wederom de predatie-term door <span class="math inline">\(N\)</span>, waardoor we functie <span class="math inline">\(\frac{aR}{h+R}\)</span> krijgen. Deze functie wordt de <strong>functionele respons</strong> van de predator genoemd. Om een beeld van deze functie te krijgen, is het handig om deze even te schetsen.</p>
</section>
<section id="vorm-van-de-nieuwe-predatieterm" class="level2">
<h2 class="anchored" data-anchor-id="vorm-van-de-nieuwe-predatieterm">Vorm van de nieuwe predatieterm</h2>
<p>Laten we eerst even naar de noemer te kijken, en vooral naarde balans tussen <span class="math inline">\(h\)</span> en <span class="math inline">\(R\)</span>. Als <span class="math inline">\(R\)</span> heel klein is, heeft <span class="math inline">\(h\)</span> de overhand in de noemer, waardoor <span class="math inline">\(R\)</span> verwaarloosbaar is. Dus voor kleine <span class="math inline">\(R\)</span> nadert de functie <span class="math inline">\(\frac{aR}{h}\)</span>, wat een lineaire toename is. Dus voor kleine prooi-dichtheden, neemt predatie lineair toe met de prooi-dichtheid, net zoals in het eerdere model. Maar als <span class="math inline">\(R\)</span> alsmaar groter wordt, wordt <span class="math inline">\(h\)</span> juist verwaarloosbaar ten opzichte van <span class="math inline">\(R\)</span>. Daarom nadert deze functie bij hoge <span class="math inline">\(R\)</span> de waarde <span class="math inline">\(\frac{aR}{R} = a\)</span>. Dus: zelfs bij hele hoge prooidichtheiden kan een enkele predator per tijdseenheid (bijv. per dag) hoogstens <span class="math inline">\(a\)</span> prooi eten. Tussen deze twee extreme waarden zit nog een laatste bijzondere punt: het punt waar <span class="math inline">\(R\)</span> precies gelijk is aan <span class="math inline">\(h\)</span>. Op dit punt is de functie gelijk aan <span class="math inline">\(\frac{aR}{R+R}=\frac{aR}{2R}=\frac{a}{2}\)</span>. De parameter <span class="math inline">\(h\)</span> geeft dus de prooi-dichtheid waar de predatieterm half-maximaal is. Nu kunnen we de functie schetsen, zoals weergegeven in <a href="#fig-predatieterm-1" class="quarto-xref">Figuur&nbsp;<span>1 (a)</span></a>.</p>
</section>
<section id="hill-functies" class="level2">
<h2 class="anchored" data-anchor-id="hill-functies">Hill-functies</h2>
<p>Functies van deze vorm worden “Hill-functies” genoemd (vernoemd naar Archibald Hill, niet naar het feit dat het een soort heuveltje is). Met een kleine aanpassing aan deze Hill-functie (<span class="math inline">\(\frac{aR^2}{h^2+R^2}\)</span>), kun je deze respons ook sigmoïde (S-vormig) laten verlopen (<a href="#fig-predatieterm-2" class="quarto-xref">Figuur&nbsp;<span>1 (b)</span></a>).</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>h<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>x<span class="sc">/</span>(x<span class="sc">+</span>h))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(func,<span class="dv">0</span>,<span class="dv">8</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.</span>), <span class="at">xaxt=</span><span class="st">"n"</span>, <span class="at">yaxt=</span><span class="st">"n"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Predatie"</span>,<span class="at">xlab=</span><span class="st">"Hoeveelheid prooi (R)"</span>,<span class="at">col=</span><span class="st">"seagreen"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">"Hill-functie (Type 2)"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">at=</span><span class="fu">c</span>(h)) <span class="co"># x-axis</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.0</span>)) <span class="co"># x-axis</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>a,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>h,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"h"</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>h,<span class="at">line=</span><span class="fl">0.7</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"0"</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">line=</span><span class="fl">0.5</span>,<span class="at">at=</span><span class="dv">0</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"0"</span>,<span class="at">side=</span><span class="dv">2</span>,<span class="at">line=</span><span class="fl">0.5</span>,<span class="at">at=</span><span class="dv">0</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">2.0</span>,<span class="dv">1</span>,<span class="st">"a"</span>,<span class="at">xpd=</span><span class="cn">NA</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">2.0</span>,<span class="fl">0.5</span>,<span class="st">"a/2"</span>,<span class="at">xpd=</span><span class="cn">NA</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>h<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(func,<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.</span>), <span class="at">xaxt=</span><span class="st">"n"</span>, <span class="at">yaxt=</span><span class="st">"n"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Predatie"</span>,<span class="at">xlab=</span><span class="st">"Hoeveelheid prooi (R)"</span>,<span class="at">col=</span><span class="st">"seagreen"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">"Hill-functie (Type 3)"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">at=</span><span class="fu">c</span>(h)) <span class="co"># x-axis</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.0</span>)) <span class="co"># x-axis</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>a,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>h,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"h"</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">at=</span>h,<span class="at">line=</span><span class="fl">0.7</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"0"</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">line=</span><span class="fl">0.5</span>,<span class="at">at=</span><span class="dv">0</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"0"</span>,<span class="at">side=</span><span class="dv">2</span>,<span class="at">line=</span><span class="fl">0.5</span>,<span class="at">at=</span><span class="dv">0</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">1</span>,<span class="st">"a"</span>,<span class="at">xpd=</span><span class="cn">NA</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="st">"a/2"</span>,<span class="at">xpd=</span><span class="cn">NA</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-predatieterm" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-predatieterm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-predatieterm" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-predatieterm-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="384">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-predatieterm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-predatieterm-1.png" class="lightbox" data-gallery="fig-predatieterm" title="Figuur&nbsp;1&nbsp;(a): "><img src="odes_grind_files/figure-html/fig-predatieterm-1.png" id="fig-predatieterm-1" class="img-fluid figure-img" data-ref-parent="fig-predatieterm" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-predatieterm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-predatieterm" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-predatieterm-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="384">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-predatieterm-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-predatieterm-2.png" class="lightbox" data-gallery="fig-predatieterm" title="Figuur&nbsp;1&nbsp;(b): "><img src="odes_grind_files/figure-html/fig-predatieterm-2.png" id="fig-predatieterm-2" class="img-fluid figure-img" data-ref-parent="fig-predatieterm" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-predatieterm-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-predatieterm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;1
</figcaption>
</figure>
</div>
<!-- ::: {#exr-hillfuncties} -->
<!-- ## Hill-functies  -->
<!-- <br><br> -->
<!-- De bovengenoemde Hill-functies zijn zeer veelzijdig, en met kleine aanpassingen kun je de vorm goed aanpassen. Vaak willen we bijvoorbeeld kunnen wisselen tussen geen interactie (0) en volledige interactie (1), of geen genexpressie (0) en volledige genexpressie (1), *etc.* Om dit te doen kunnen we de parameter $a$ op 1 zetten, waardoor we deze volledig weg kunnen laten uit de hill-functie. -->
<!-- Neem de onderstaande code over in R: -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- h=1 -->
<!-- n=2 -->
<!-- func <- function(x){ -->
<!--   return(x^n/(x^n+h^n)) -->
<!-- } -->
<!-- curve(func,0,3,lwd=2.5,ylim=c(0,1.),  -->
<!--       ylab="f(x)",xlab="x",col="seagreen") -->
<!-- ``` -->
<!-- Stel dat we de interacties tussen genen bestuderen die elkaars expressie beïnvloeden. Hoewel de bovengenoemde Hill-functies een graduele overgang beschrijven, zien we in dit (hypothetische) scenario iets anders. We zien dat een klein beetje expressie van gen 1 geen invloed heeft op gen 2, maar dat er bij een bepaalde kritische expressie van gen 1 plotseling maximale expressie van gen 2 is. Nog meer expressie van gen 1 heeft geen verdere invloed op de expressie van gen 2. -->
<!--   a. Bestudeer hoe je de Hill-functie in de R-code hierboven zou kunnen aanpassen om het bovengenoemde scenario met een plotseling overgang te modelleren (neem aan dat $x$ de expressie van gen 1 is, en dat op de y-as de expressie van gen 2 staat). -->
<!-- We zien dat gen 2 ook een effect heeft op gen 1. Dit effect is wél gradueel, maar er vindt juist remming plaats.  -->
<!--   b. Hoe kun je de Hill-functie omkeren zodat deze niet van 0 naar 1 gaat, maar van 1 naar 0 gaat? Schrijf de vergelijking op, en test het met je R script.  -->
<!--   c. Kun je de vergelijking die je hebt opgeschreven in b nog versimpelen? (je kunt je algebra altijd even controleren met het R-script!)  -->
<!--   d. Wat moet je doen als je toch wil dat de maximale genexpressie $a$ is, en niet 1?  -->
<!-- ::: -->
<p>Nu we kennis hebben gemaakt met Hill-functies (zie ook <a href="#tip-hillfuncties" class="quarto-xref">Tip&nbsp;<span>1</span></a>), gaan we terug naar het Lotka-Volterra model. Omdat het Lotka-Volterra model is uitgebreid met deze verzadigingsterm, moeten we opnieuw de nullclines uitrekenen en schetsen (ook die zijn veranderd!). Maar zoals je je wellicht kan voorstellen worden de nullclines iets ingewikkelder door deze non-lineaire term in onze vergelijkingen. Naar mate we onze modellen meer en meer uitbreiden, wordt het natuurlijk steeds lastiger om alles met de hand te doen. Daarom gaan we in dit hoofdstuk de faseruimte en het vectorveld laten tekenen door grind.R, een Rscript dat deze analyses een fluitje van een cent maakt!</p>
<div id="tip-hillfuncties" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: Veel gebruikte Hill-functies
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 61%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Naam</th>
<th>Vergelijking</th>
<th>Grafiek</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Type II</td>
<td><span class="math display">\[\frac{x}{x+h}\]</span></td>
<td><img src="figuren/hill_small_t1.png" class="img-fluid" width="250"></td>
</tr>
<tr class="even">
<td>Type III</td>
<td><span class="math display">\[\frac{x^2}{x^2+h^2}\]</span></td>
<td><img src="figuren/hill_small_t2.png" class="img-fluid" width="250"></td>
</tr>
<tr class="odd">
<td>Type II (afnemend)</td>
<td><span class="math display">\[1-\frac{x}{x+h} = \frac{1}{x/h+1}\]</span></td>
<td><img src="figuren/hill_small_inv_t1.png" class="img-fluid" width="250"></td>
</tr>
<tr class="even">
<td>Type III (afnemend)</td>
<td><span class="math display">\[1-\frac{x^2}{x^2+h^2} = \frac{1}{\frac{x^2}{h^2}+1}\]</span></td>
<td><img src="figuren/hill_small_inv_t2.png" class="img-fluid" width="250"></td>
</tr>
</tbody>
</table>
<div class="line-block"></div>
</div>
</div>
</div>
</section>
<section id="grind-tutorial" class="level2">
<h2 class="anchored" data-anchor-id="grind-tutorial">Grind tutorial</h2>
<p>Grind (<em>GReat INtegrator Differential equations</em>) is een Rscript geschreven door Rob de Boer (<a href="https://tbb.bio.uu.nl/rdb" class="uri">https://tbb.bio.uu.nl/rdb</a>), wat het heel makkelijk maakt om faseruimtes, vectorvelden, en oplossingen te berekenen en plotten. Ook kun je Grind gebruiken om modellen te fitten aan experimentele data, zodat je op basis van metingen in het veld parameters als <span class="math inline">\(b\)</span>, <span class="math inline">\(d\)</span>, <span class="math inline">\(K\)</span>, en <span class="math inline">\(h\)</span> zou kunnen schatten. Dat laatste is heel relevant wanneer modellen gebruikt worden voor (bijvoorbeeld) belangrijke beleidsbeslissingen, maar in deze cursus gaan we het vooral gebruiken om gemakkelijk faseruimtes met nullclines te schetsen, en oplossingen te bestuderen. De volledige handleiding en introductie tot Grind vind je <a href="https://tbb.bio.uu.nl/rdb/grindR/basics.html">hier</a>.</p>
<p>Voordat je Grind kan gebruiken, moet je eenmalig een paar “packages” in R installeren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installeer de packages (hoeft maar 1 keer!)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"FME"</span>, <span class="st">"deSolve"</span>,<span class="st">"coda"</span>,<span class="st">"rootSolve"</span>) </span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nadat deze packages zijn geinstalleerd, moeten we het grind.R script inladen. Dit kan je vanaf de website doen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://tbb.bio.uu.nl/rdb/grindR/grind.R"</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Of vanaf je eigen computer als je het script hebt gedownload:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"C:/Student/Modellen/grind.R"</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Als het laden van het script goed is gegaan, krijg je een melding:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>grind.R (25-06-2024) was sourced</code></pre>
</div>
</div>
<p>Nu kunnen we grind.R gebruiken. De differentiaalvergelijkingen staan in een functie genaamd ‘model’<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state,parms)), {</span>
<span id="cb6-3"><a href="#cb6-3"></a>    dR <span class="ot">&lt;-</span> r<span class="sc">*</span>R<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> R<span class="sc">/</span>K) <span class="sc">-</span> a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h)</span>
<span id="cb6-4"><a href="#cb6-4"></a>    dN <span class="ot">&lt;-</span> c<span class="sc">*</span>a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h) <span class="sc">-</span> delta<span class="sc">*</span>N</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dR, dN)))  </span>
<span id="cb6-6"><a href="#cb6-6"></a>  }) </span>
<span id="cb6-7"><a href="#cb6-7"></a>}  </span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En vervolgens geef je de parameters en begin-waarden (<em>initial condition</em>) voor de variabelen aan:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r=</span><span class="dv">1</span>,<span class="at">K=</span><span class="dv">1</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">delta=</span><span class="fl">0.3</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">h=</span><span class="dv">1</span>)  <span class="co">#parameters</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R=</span><span class="dv">1</span>,<span class="at">N=</span><span class="fl">0.01</span>) <span class="co">#begin-dichtheden van R en N  </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>colors[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">"blue"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>colors[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">"#FF7F50"</span></span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hierboven geef ik ook even de nieuwe kleuren aan voor de ‘eerste’ en ‘tweede’ vergelijking, zodat dit overeenkomt met de kleuren die we tot nu toe hebben gebruikt. Dit is niet noodzakelijk, maar zo raken we niet in de war.</p>
<p>Nu kun je met met de functie <code>run</code> eenvoudig een oplossing uitrekenen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>()</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="odes_grind_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="odes_grind_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        R         N 
0.4285768 0.8163156 </code></pre>
</div>
</div>
<p>Zoals je ziet genereert Grind een grafiek (een oplossing), en vertelt het ook meteen wat de eind-waarden zijn van je variabelen.</p>
<p>We kunnen ook argumenten aan <code>run</code> meegeven, bijvoorbeeld om wat langer door te rekenen (<code>tmax</code>, deze optie is standaard 100) en een optie om y-as logaritmisch te schalen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tmax=</span><span class="dv">200</span>,<span class="at">log =</span> <span class="st">"y"</span>) </span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="odes_grind_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="odes_grind_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        R         N 
0.4285714 0.8163265 </code></pre>
</div>
</div>
<p>Zoals je ziet zijn de waarden na tijdstip 100 niet meer veel veranderd. Het systeem was dus eigenlijk al (bijna) in evenwicht.</p>
<p>We kunnen ook een faseruimte maken met de functie <code>plane</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>() </span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="odes_grind_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="odes_grind_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Ook deze functie kunnen we weer argumenten meegeven, bijvoorbeeld om de assen iets verder te vergroten en een vectorveld te tekenen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax=</span><span class="fl">1.5</span>, <span class="at">ymax=</span><span class="fl">1.5</span>,<span class="at">vector =</span> T) </span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="odes_grind_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="odes_grind_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Als laatste willen we (net als in het vorige hoofdstuk) weten of de evenwichten stabiel of instabiel zijn. Hiervoor geven we Grind een geschatte waarde dichtbij een evenwicht mee, en gebruiken we de functie <code>newton</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax=</span><span class="fl">1.5</span>, <span class="at">ymax=</span><span class="fl">1.5</span>,<span class="at">vector =</span> T)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">state=</span><span class="fu">c</span>(<span class="at">R=</span><span class="fl">0.0</span>,<span class="at">N=</span><span class="fl">0.0</span>),<span class="at">plot=</span>T)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">state=</span><span class="fu">c</span>(<span class="at">R=</span><span class="fl">1.0</span>,<span class="at">N=</span><span class="fl">0.0</span>),<span class="at">plot=</span>T)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">state=</span><span class="fu">c</span>(<span class="at">R=</span><span class="fl">0.4</span>,<span class="at">N=</span><span class="fl">0.8</span>),<span class="at">plot=</span>T)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">traject =</span> T)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="odes_grind_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="odes_grind_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>De laatste regel gebruikt <code>run</code> met de optie <code>traject=T</code> om een trajectorie door de faseruimte te tekenen. Dit vertaalt het grafiekje door de tijd die we eerder hebben uitgerekend, naar een mooie inwaardse spiraal. Er zijn nog <a href="https://tbb.bio.uu.nl/rdb/grindR/basics.html">veel meer opties</a> in grind.R. Als je wil zien welke argumenten een functie allemaal kent, kun je gebruik maken van <code>args</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(plane)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (xmin = -0.001, xmax = 1.05, ymin = -0.001, ymax = 1.05, 
    xlab = "", ylab = "", log = "", npixels = 500, state = s, 
    parms = p, odes = model, x = 1, y = 2, time = 0, grid = 5, 
    eps = NULL, show = NULL, addone = FALSE, portrait = FALSE, 
    vector = FALSE, add = FALSE, legend = TRUE, zero = TRUE, 
    lwd = 2, col = "black", pch = 20, ...) 
NULL</code></pre>
</div>
</div>
<p>Zo zie je bijvoorbeeld dat je de legenda zou kunnen verbergen met de <code>legend</code> optie, of de lijndikte (<code>lwd</code>) zou kunnen aanpassen. Met andere woorden: met R kunnen we zonder al te veel rekenwerk prachtige figuren genereren en wiskundige modellen doorrekenen!</p>
</section>
<section id="lotka-volterra-in-grind" class="level2">
<h2 class="anchored" data-anchor-id="lotka-volterra-in-grind">Lotka-Volterra in Grind</h2>
<p>Als je de bovenstaande tutorial hebt gevolgd (en de packages hebt geïnstalleerd), kun je nu het volgende script overnemen en aan de slag met het uitbreiding van het Lotka-Volterra model waar de predatieterm verzadigt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state,parms)), {</span>
<span id="cb17-3"><a href="#cb17-3"></a>    dR <span class="ot">&lt;-</span> r<span class="sc">*</span>R<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> R<span class="sc">/</span>K) <span class="sc">-</span> a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h)</span>
<span id="cb17-4"><a href="#cb17-4"></a>    dN <span class="ot">&lt;-</span> c<span class="sc">*</span>a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h) <span class="sc">-</span> delta<span class="sc">*</span>N</span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dR, dN)))  </span>
<span id="cb17-6"><a href="#cb17-6"></a>  }) </span>
<span id="cb17-7"><a href="#cb17-7"></a>}  </span>
<span id="cb17-8"><a href="#cb17-8"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r=</span><span class="dv">1</span>,<span class="at">K=</span><span class="dv">2</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">delta=</span><span class="fl">0.3</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">h=</span><span class="dv">1</span>)  <span class="co">#parameters</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R=</span><span class="dv">1</span>,<span class="at">N=</span><span class="fl">0.01</span>) <span class="co">#begin-dichtheden van R en N  </span></span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a>colors[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">"blue"</span> <span class="co">#optioneel, default = 'red'</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>colors[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">"#FF7F50"</span> <span class="co">#optioneel, default = 'blue'</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># optioneel, maakt 2 plotjes naast elkaar</span></span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="fu">plane</span>(<span class="at">xmax=</span><span class="dv">3</span>,<span class="at">ymax=</span><span class="dv">2</span>)</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="fu">run</span>(<span class="at">tstep=</span><span class="fl">0.5</span>, <span class="at">legend=</span>F)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="odes_grind_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="odes_grind_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       R        N 
0.605847 1.582674 </code></pre>
</div>
</div>
<p>Door te oefenen met dit R-script, naast de pen en papier opgaven, is het de bedoeling dat je een goed gevoel ontwikkelt voor ODEs: wiskundige modellen die veel in de biologische literatuur voorkomen. Hieronder volgt een korte vraag, om met zowel pen en papier als Grind te oefenen.</p>
<div id="exr-paraboollv" class="theorem exercise">
<p><span class="theorem-title"><strong>Oefening 1 (De nieuwe nullcline voor de prooi)</strong></span> <br></p>
<p>Hierboven hebben we nullclines gegenereerd van het vernieuwde Lotka-Volterra model (met een verzadigbare predator). Zoals je ziet is dit geen rechte lijn meer.</p>
<ol type="a">
<li>Bepaal met pen en papier aan welke functie de vernieuwde nullcline voor de prooi voldoet.</li>
<li>Wat is het effect van de <span class="math inline">\(K\)</span> parameter op de ligging van deze nullcline?</li>
<li>Neem het R-script hierboven over met het Lotka-Volterra model met verzadigbare predator. Verdubbel de waarde van <span class="math inline">\(K\)</span>. Wat valt je op?</li>
</ol>
</div>
</section>
<section id="bifurcaties-van-evenwichten" class="level2">
<h2 class="anchored" data-anchor-id="bifurcaties-van-evenwichten">Bifurcaties van evenwichten</h2>
<p>Het model met verzadigbare predator heeft een interessante eigenschap: afhankelijk van de parameters kan het type evenwicht veranderen. Iets dergelijks zagen we ook al eerder terug: de predator kon alleen samenleven met de prooi als de parameters dat toelieten. Deze transitie zien we ook terug in dit vernieuwde model (van <a href="#fig-lvvoort-1" class="quarto-xref">Figuur&nbsp;<span>2 (a)</span></a> naar <a href="#fig-lvvoort-2" class="quarto-xref">Figuur&nbsp;<span>2 (b)</span></a>). Deze bifurcatie (van geen samenleving naar wél samenleving) wordt een <strong>kritische transitie</strong> genoemd. Echter is er met dit vernieuwde model een tweede bifurcatie mogelijk: de predator-nullcline kan de prooi-nullcine links of rechts van de top van de parabool snijden (van <a href="#fig-lvvoort-2" class="quarto-xref">Figuur&nbsp;<span>2 (b)</span></a> naar <a href="#fig-lvvoort-3" class="quarto-xref">Figuur&nbsp;<span>2 (c)</span></a>). Als het snijpunt links van de top van de parabool ligt, zien we voortdurende oscillaties van predator en prooi, waarbij de populaties om het instabiele evenwicht heen blijven draaien. Eerder hadden we al gezegd dat attractoren niet altijd hetzelfde zijn als het evenwichtspunt, en hier zie je dat heel goed! Deze <strong>attractor</strong>, waarbij de populaties constant om het evenwicht heen blijven draaien, heet een limietcyclus. De overgang van de stabiele spiraal (snijpunt rechts van de parabool) naar de instabiele spiraal (snijpunt links van de parabool) staat bekend als de <strong>Hopf-bifurcatie</strong>.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state,parms)), {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> r<span class="sc">*</span>R<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> R<span class="sc">/</span>K) <span class="sc">-</span> a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    dN <span class="ot">&lt;-</span> c<span class="sc">*</span>a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h) <span class="sc">-</span> delta<span class="sc">*</span>N</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dR, dN)))  </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  }) </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>colors[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">"blue"</span> <span class="co">#optioneel, default = 'red'</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>colors[<span class="dv">2</span>] <span class="ot">=</span> <span class="st">"#FF7F50"</span> <span class="co">#optioneel, default = 'blue'</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r=</span><span class="dv">1</span>,<span class="at">K=</span><span class="fl">0.4</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">delta=</span><span class="fl">0.3</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">h=</span><span class="dv">1</span>)  <span class="co">#parameters</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R=</span><span class="fl">0.4</span>,<span class="at">N=</span><span class="fl">0.01</span>) <span class="co">#begin-dichtheden van R en N  </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax=</span><span class="fl">2.2</span>,<span class="at">ymax=</span><span class="dv">2</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tstep=</span><span class="fl">0.5</span>, <span class="at">traject=</span>T,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">state=</span><span class="fu">c</span>(<span class="at">R=</span><span class="fl">0.5</span>,<span class="at">N=</span><span class="fl">0.5</span>),<span class="at">plot=</span>T)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r=</span><span class="dv">1</span>,<span class="at">K=</span><span class="dv">1</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">delta=</span><span class="fl">0.3</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">h=</span><span class="dv">1</span>)  <span class="co">#parameters</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R=</span><span class="dv">2</span>,<span class="at">N=</span><span class="fl">0.01</span>) <span class="co">#begin-dichtheden van R en N  </span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax=</span><span class="fl">2.2</span>,<span class="at">ymax=</span><span class="dv">2</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tstep=</span><span class="fl">0.5</span>, <span class="at">traject=</span>T,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">state=</span><span class="fu">c</span>(<span class="at">R=</span><span class="fl">0.5</span>,<span class="at">N=</span><span class="fl">0.5</span>),<span class="at">plot=</span>T)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r=</span><span class="dv">1</span>,<span class="at">K=</span><span class="dv">2</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">delta=</span><span class="fl">0.3</span>,<span class="at">c=</span><span class="dv">1</span>,<span class="at">h=</span><span class="dv">1</span>)  <span class="co">#parameters</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R=</span><span class="dv">2</span>,<span class="at">N=</span><span class="fl">0.01</span>) <span class="co">#begin-dichtheden van R en N  </span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax=</span><span class="fl">2.2</span>,<span class="at">ymax=</span><span class="dv">2</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tstep=</span><span class="fl">0.5</span>, <span class="at">traject=</span>T,<span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">state=</span><span class="fu">c</span>(<span class="at">R=</span><span class="fl">0.5</span>,<span class="at">N=</span><span class="fl">0.5</span>),<span class="at">plot=</span>T)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-lvvoort" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lvvoort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-lvvoort" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-lvvoort-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lvvoort-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-lvvoort-1.png" class="lightbox" data-gallery="fig-lvvoort" title="Figuur&nbsp;2&nbsp;(a): Als de nullclines niet snijden, is er geen evenwicht."><img src="odes_grind_files/figure-html/fig-lvvoort-1.png" class="img-fluid figure-img" data-ref-parent="fig-lvvoort" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lvvoort-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Als de nullclines niet snijden, is er geen evenwicht.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-lvvoort" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-lvvoort-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lvvoort-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-lvvoort-2.png" class="lightbox" data-gallery="fig-lvvoort" title="Figuur&nbsp;2&nbsp;(b): Vertrouwde inwaartse spiraal die naar een stabiel evenwicht gaat."><img src="odes_grind_files/figure-html/fig-lvvoort-2.png" class="img-fluid figure-img" data-ref-parent="fig-lvvoort" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lvvoort-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Vertrouwde inwaartse spiraal die naar een stabiel evenwicht gaat.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-lvvoort" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-lvvoort-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lvvoort-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-lvvoort-3.png" class="lightbox" data-gallery="fig-lvvoort" title="Figuur&nbsp;2&nbsp;(c): Voortdurende oscillaties rond een instabiel evenwicht."><img src="odes_grind_files/figure-html/fig-lvvoort-3.png" class="img-fluid figure-img" data-ref-parent="fig-lvvoort" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lvvoort-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Voortdurende oscillaties rond een instabiel evenwicht.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lvvoort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;2: Verschillende faseruimtes voor het predator-prooi model met verzadigbare predator
</figcaption>
</figure>
</div>
<p>Voortdurende oscillaties tussen prooi en predator worden inderdaad waargenomen, bijvoorbeeld de oscillaties tussen hazen en lynxen in Noord Amerika (<a href="#fig-hazenenlynxen" class="quarto-xref">Figuur&nbsp;<span>3</span></a>). Ook in experimenten zijn dergelijke oscillaties waargenomen, bijvoorbeeld door <em>Paramecium</em> (een-cellige protist, prooi) en <em>Didinium</em> (eencellige protist, predator) samen te groeien in een Erlenmeyer (Xia <em>et al.</em>, 1992).</p>
<div id="fig-hazenenlynxen" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hazenenlynxen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="figuren/hazen_en_lynxen.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figuur&nbsp;3: Populatieaantallen hazen en lynxen in Noord Amerika van medio 19e eeuw tot medio 20e eeuw (bepaald op basis van de vachtenverkoop, zie Elton &amp; Nicholson 1942)"><img src="figuren/hazen_en_lynxen.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hazenenlynxen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3: Populatieaantallen hazen en lynxen in Noord Amerika van medio 19e eeuw tot medio 20e eeuw (bepaald op basis van de vachtenverkoop, zie Elton &amp; Nicholson 1942)
</figcaption>
</figure>
</div>
<p>Bifurcaties kun je weergeven in een bifurcatiediagram, waarbij we de parameter die het evenwicht beïnvloedt op de x-as zetten, en de populatiegroottes in evenwicht op de y-as. Als we dit doen voor de bovenstaande bifurcaties, krijgen we dit:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>my_theme <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms){</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state,parms)),{</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> R<span class="sc">*</span>(b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>R<span class="sc">/</span>K)<span class="sc">-</span>d) <span class="sc">-</span> a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    dN <span class="ot">&lt;-</span> c<span class="sc">*</span>a<span class="sc">*</span>R<span class="sc">*</span>N<span class="sc">/</span>(R<span class="sc">+</span>h) <span class="sc">-</span> delta<span class="sc">*</span>N</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dR,dN)))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># all &lt;- data.frame()</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># for(k in c(0.00001,seq(0.001,4.0,by=0.001))){</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   p &lt;- c(a=0.5,delta=0.25,b=0.5,d=0.01,c=0.99,K=k,h=1)</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   s &lt;- c(R=0.4,N=0.4)</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   plane(ymax=1.2,ymin=-0.1,xmin=-0.01, xmax=1.2,tstep=0.01,tmax=50)</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   #res &lt;- newton()</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   dat &lt;- run(table=T,step=11,tmax=1000,timeplot=F)</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   dat$K = k</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   all &lt;- rbind(all,tail(dat,100))</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   cat(k,"\n")</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># bifurcation_data &lt;- all %&gt;% group_by(K) %&gt;% </span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(maxN=max(N)) %&gt;% </span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(minN=min(N)) %&gt;% </span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(maxR=max(R)) %&gt;% </span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(minR=min(R)) %&gt;% </span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(time==1000) %&gt;% </span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct()</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co"># write.table(bifurcation_data, "Modellering/figuren/bifurcation_data.csv")</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>bifurcation_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"figuren/bifurcation_data.csv"</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="co">#list.files("figuren")</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"N"</span> <span class="ot">=</span> <span class="st">"#FF7F50"</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>bifurcation_data <span class="sc">%&gt;%</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>maxN)) <span class="sc">+</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(col="#FF7F50",linewidth=1, aes(color="N")) +</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>maxR,<span class="at">color=</span><span class="st">"R"</span>),<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>minR,<span class="at">color=</span><span class="st">"R"</span>),<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>minN,<span class="at">color=</span><span class="st">"N"</span>),<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>maxN,<span class="at">color=</span><span class="st">"N"</span>),<span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Population sizes"</span>) <span class="sc">+</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  my_theme <span class="sc">+</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">"Soort"</span>,<span class="at">values =</span> colors)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lvbif" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lvbif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-lvbif-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figuur&nbsp;4: Bifurcatiediagram van het Lotka-Volterra predator-prooi model"><img src="odes_grind_files/figure-html/fig-lvbif-1.png" class="img-fluid figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lvbif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;4: Bifurcatiediagram van het Lotka-Volterra predator-prooi model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Omdat er bij hoge waarden van <span class="math inline">\(K\)</span> oscillaties zijn, geven de lijnen de minimale en maximale waarde van deze oscillaties aan. Omdat de parameter <span class="math inline">\(K\)</span> het draagvlak van de prooi beinvloed, geeft dit diagram dus weer wat er bijvoorbeeld zou gebeuren als we konijnen op de Veluwe gaan bijvoeren: eerst krijgen we meer konijnen, dan krijgen we alleen meer predatoren, en daarna begint het systeem harder en harder te schommelen! Zo zie je: het behoud van biodiversiteit is zelfs in dit simplistische “ecosysteem” niet triviaal!</p>
</section>
<section id="grind.r-kan-nog-veel-meer" class="level2">
<h2 class="anchored" data-anchor-id="grind.r-kan-nog-veel-meer">grind.R kan nog veel meer</h2>
<p>Met het R-script <code>grind.R</code> kan je nog veel meer dan alleen faseplaatjes en bifurcaties analyseren. Zo kan je bijvoorbeeld met een zogeheten “interactie matrix” (waarin staat hoe alle soorten interacteren met alle soorten) een heel ecosysteem doorrekenen (zie <a href="#fig-grindvoorbeeld" class="quarto-xref">Figuur&nbsp;<span>5</span></a> voor een voorbeeld met 30 soorten), wat fascinerend complexe en onvoorspelbare dynamiek kan opleveren. Hoewel <a href="https://tbb.bio.uu.nl/rdb/grindR/manual.html">het brede scale aan functionaliteiten van grind.R</a> leuk zijn om mee te spelen, is dit geen leerstof. De algemene boodschap is dat we voor meer ingewikkelde systemen meestal niet met pen en papier te hoeven rekenen, maar de computer het werk kunnen laten doen!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://tbb.bio.uu.nl/rdb/grindR/grind.R"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> state</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> A <span class="sc">%*%</span> N <span class="co"># R code for matrix x vector multiplication</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  dN <span class="ot">&lt;-</span> r<span class="sc">*</span>N<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> S)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dN))  </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.01</span>,n)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(s) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"N"</span>,<span class="fu">seq</span>(<span class="dv">1</span>,n),<span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(n,<span class="dv">1</span>,<span class="fl">0.1</span>))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>n),<span class="at">nrow=</span>n,<span class="at">ncol=</span>n)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(A) <span class="ot">&lt;-</span> <span class="dv">1</span>; A</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tmax=</span><span class="dv">300</span>,<span class="at">legend=</span>F)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grindvoorbeeld" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grindvoorbeeld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="odes_grind_files/figure-html/fig-grindvoorbeeld-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figuur&nbsp;5: "><img src="odes_grind_files/figure-html/fig-grindvoorbeeld-1.png" id="fig-grindvoorbeeld" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-grindvoorbeeld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;5
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="terminologie" class="level2">
<h2 class="anchored" data-anchor-id="terminologie">Terminologie</h2>
<table class="table-striped table-hover caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Nederlands</th>
<th>Engels</th>
<th>Beschrijving</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hill-functies</td>
<td>Hill functions</td>
<td>Een set wiskundige functies die verzadigen bij grote waarden (ze hebben een horizontale assymptoot).</td>
</tr>
<tr class="even">
<td>Kritische-transitie</td>
<td>Critical Transition</td>
<td>Een punt waarbij een parameter-verandering het gedrag van een model fundamenteel verandert, bijvoorbeeld doordat het aantal of de stabiliteit van de evenwichten verandert. In dit hoofdstuk zien we bijvoorbeeld dat er alleen samenleving mogelijk is als <span class="math inline">\(K\)</span> hoog genoeg is. Er is dus een waarde van <span class="math inline">\(K\)</span> waarbij er een kritische transitie is.</td>
</tr>
<tr class="odd">
<td>Hopf-bifurcatie</td>
<td>Hopf-bifurcation</td>
<td>Een omslagpunt waar, als je een bepaalde parameter verandert, een stabiel evenwicht overgaat in periodiek gedrag (of andersom). In dit hoofdstuk zagen we dit terug doordat het verhogen van <span class="math inline">\(K\)</span> de stabiele samenleving van predator en prooi kan veranderen in periodieke oscillaties van de populatiegroottes.</td>
</tr>
</tbody>
</table>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Op regel 2 zie dat dat deze ‘model’-functie zit een beetje raar zit ingepakt in een <code>with</code> functie. Dit heeft een technische reden (en is zeker geen leerstof), maar helpt R begrijpen hoe de variabelen/parameters heten. De enige regels die je eigenlijk hoeft aan te passen zijn degene met de vergelijkingen (hier regel 3 en 4), en zorgen dat deze vergelijkingen in de goede volgorde worden teruggegeven (regel 5).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Modellen/predatorprooi.html" class="pagination-link" aria-label="Predator-prooi interacties">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Predator-prooi interacties</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Modellen/competitie.html" class="pagination-link" aria-label="Competitie en evolutie">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Competitie en evolutie</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Vakgroep Theoretische Biologie, Universiteit Utrecht.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Dit boek is gemaakt met <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","loop":false,"closeEffect":"zoom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>